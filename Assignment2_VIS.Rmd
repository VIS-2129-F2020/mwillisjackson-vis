---
title: "Assignment2_VIS"
author: "Megan Willis-Jackson"
date: "9/18/2020"
output: 
  html_document: 
    toc: yes
    toc_float: yes
---


# Load Libraries

```{r load libraries, message=F, results='hide'}
library(ggplot2)
library(sf)
library(rnaturalearth)
library(rnaturalearthdata)
library(rgeos)
library(tidyverse)
library(ggspatial)
library(cartogram)
library(ggthemes)
library(rnaturalearthhires)
library(ggrepel)
library(gridExtra)

```

# Select Area

```{r}
africa<- ne_countries(scale = 50, returnclass = "sf") %>% 
  filter(continent == "Africa")

africa[38,35]<- 652271

#the following two lines of code ensure that the dorling cartograph will work; an error pops up otherwise.
africa$area<- NA
africa$area<- africa$geometry

africa_map<- ggplot(africa) +
  geom_sf() +
  theme_bw()

africa_map +
  annotation_scale(bar_cols = "grey")


```

# Different Coordinate Projections

I try out a bunch of different projections below. I do not end up using all of them in the subsequent visualizations, but I am leaving them in here to be able to quickly switch it up if I want to in the future.

```{r change projections}
africa_sinusoidal<- "+proj=sinu +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs"

africa_lambert<- "+proj=lcc +lat_1=20 +lat_2=-23 +lat_0=0 +lon_0=25 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs"

africa_equidistant<- "+proj=eqdc +lat_0=0 +lon_0=0 +lat_1=20 +lat_2=-23 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs"

africa_albers<- "+proj=aea +lat_1=36.5 +lat_2=29.071428571429 +lat_0=32.7857142857145 +lon_0=-14.111111111111 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs"

africa_abc<- "+proj=aea +lat_1=-18 +lat_2=-32 +lat_0=0 +lon_0=24 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs"

africa_wafrica<- "+proj=tmerc +lat_0=0 +lon_0=7.3 +k=0.999 +x_0=1000000 +y_0=1000000 +ellps=WGS84 +datum=WGS84 +units=m +no_defs"

africa_brads<- "+proj=tmerc +lat_0=0 +lon_0=31 +k=1 +x_0=0 +y_0=0 +ellps=WGS84 +units=m +no_defs"

africa_laea<- "+proj=laea +lat_0=-10 +lon_0=35 +x_0=0 +y_0=0 +ellps=WGS84 +units=m +no_defs"

africa_massachusetts<-"+proj=lcc +lat_1=42.68333333333333 +lat_2=41.71666666666667 +lat_0=41 +lon_0=-71.5 +x_0=200000.0001016002 +y_0=750000 +ellps=GRS80 +datum=NAD83 +to_meter=0.3048006096012192 +no_defs"


```


## Projection 1: Lambert Conformal Conic Projection
This projection is created to make the state of Massachusetts look as accurate as possible. Projecting the African continent using it makes the southern section of the continent look wider and longer in comparison to the northern part.

```{r map new projections}

africa_map +
  geom_sf() +
  coord_sf(crs = africa_massachusetts) +
  annotation_scale() +
  theme_economist()

```

## Projection 2: Transverse Mercator Projection
This projection looks to be more spatially accurate for east/central Africa. West Africa bends upwards in this projection in a way not seen on most maps.

```{r}

africa_map +
  geom_sf() +
  coord_sf(crs = africa_brads) +
  annotation_scale() +
  theme_economist()

```

## Projection 3: Albers Equal Area Conic
This projection seems appropriate to spatially display southern Africa. The large northern section of the continent is very stretched out.

```{r}
africa_map +
  geom_sf() +
  coord_sf(crs = africa_abc) +
  annotation_scale() +
  theme_economist()

```

# Transform the Coordinate System

```{r map transformed}
africa_transformed_massachusetts<- africa %>%
  st_transform(crs = africa_massachusetts)

africa_transformed_brads<- africa %>%
  st_transform(crs = africa_brads)

africa_transformed_abc<- africa %>%
  st_transform(crs = africa_abc)


```

# Visualizations of GDP
## Chloropleth Map

```{r plot data}
ggplot(africa_transformed_brads,
       aes(fill = gdp_md_est), ) +
  geom_sf(color = "black", size = .01) +
  annotation_scale() +
  scale_fill_viridis_c(
    name = "GDP (USD)",
    breaks = seq(0,500000, by = 100000),
    labels = c("$0","$100M","$200M","$300M","$400M","$500M")) +
    geom_sf_label(aes(geometry, label = abbrev), size = 1.8, color = "white", fill = NA, label.size = NA, fontface = "bold", ) +
  theme(panel.background = element_rect(fill = "light blue"), axis.title.x = element_text(size = 0), axis.title.y = element_text(size = 0)) +
  labs(title = "GDP by Country")

```

## Continuous Cartogram

```{r cartogram, message=F}
gdp_cart_cont<- africa_transformed_brads %>%
  cartogram_cont("pop_est")

ggplot(gdp_cart_cont,
       aes(fill = gdp_md_est)) +
  geom_sf(color = "black", size = .01) +
  scale_fill_gradient2_tableau(
    name = "GDP (USD)",
    breaks = seq(0,500000, by = 100000),
    labels = c("$0","$100M","$200M","$300M","$400M","$500M")) +
  geom_sf_label(aes(geometry, label = abbrev), size = 1.8, color = "white", fill = NA, label.size = NA, fontface = "bold") +
  theme(panel.background = element_rect(fill = "black"), axis.title.x = element_text(size = 0), axis.title.y = element_text(size = 0)) +
  labs(title = "GDP by Country, Showing Population \n(Continuous Cartogram)")



```

## Dorling Cartogram

```{r dorling, message=F}
gdp_cart_dorling<- africa_transformed_brads %>%
  cartogram_dorling("pop_est")

gdp_cart_dorling %>%
ggplot(aes(fill = gdp_md_est)) +
  geom_sf(color = NA) +
  scale_fill_gradient2_tableau(
    name = "GDP (USD)",
    breaks = seq(0,500000, by = 100000),
    labels = c("$0","$100M","$200M","$300M","$400M","$500M"))  +
  geom_sf_label(aes(geometry, label = abbrev), size = 1.8, color = "white", fill = NA, label.size = NA, fontface = "bold") +
  theme(panel.background = element_rect(fill = "black"), axis.title.x = element_text(size = 0), axis.title.y = element_text(size = 0)) +
  labs(title = "GDP by Country, Showing Population \n(Dorling Cartogram)")

```

## Non-Continuous Cartogram

```{r ncont, message=F}
gdp_cart_ncont<- africa_transformed_brads %>%
  cartogram_ncont("pop_est")

ggplot(gdp_cart_ncont,
       aes(fill = gdp_md_est)) +
  geom_sf(color = NA) +
  scale_fill_gradient2(
    name = "GDP (USD)",
    breaks = seq(0,500000, by = 100000),
    labels = c("$0","$100M","$200M","$300M","$400M","$500M")) +
  geom_sf_label(aes(geometry, label = abbrev), size = 1.8, color = "black", fill = NA, label.size = NA, fontface = "bold") +
  labs(title = "GDP by Country, Showing Population \n(Non-Continuous Cartogram)") +
  theme(axis.title.x = element_text(size = 0), axis.title.y = element_text(size = 0))




```